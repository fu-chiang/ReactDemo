{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{Outlet,useNavigate,NavLink}from'react-router-dom';import axios from'axios';import{useEffect,useReducer}from'react';import Message from'../../components/Message';import{MessageContext,messageReducer,initState}from'../../store/messageStore';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Dashboard(){var _document$cookie$spli;var navigate=useNavigate();var reducer=useReducer(messageReducer,initState);var logout=function logout(){document.cookie='hexToken=;';navigate('/login');};// 取出 Token\nvar token=(_document$cookie$spli=document.cookie.split('; ').find(function(row){return row.startsWith('hexToken=');}))===null||_document$cookie$spli===void 0?void 0:_document$cookie$spli.split('=')[1];axios.defaults.headers.common['Authorization']=token;useEffect(function(){if(!token){return navigate('/login');}_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post('/v2/api/user/check');case 3:_context.next=8;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);if(!_context.t0.response.data.success){navigate('/login');}case 8:case\"end\":return _context.stop();}},_callee,null,[[0,5]]);}))();},[navigate,token]);return/*#__PURE__*/_jsxs(MessageContext.Provider,{value:reducer,children:[/*#__PURE__*/_jsx(Message,{}),/*#__PURE__*/_jsx(\"nav\",{className:\"navbar navbar-expand-lg bg-dark\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white mb-0\",children:\"\\u8D85\\u5F37\\u65E9\\u9910\\u5F8C\\u53F0\\u7BA1\\u7406\"}),/*#__PURE__*/_jsx(\"button\",{className:\"navbar-toggler\",type:\"button\",\"data-bs-toggle\":\"collapse\",\"data-bs-target\":\"#navbarNav\",\"aria-controls\":\"navbarNav\",\"aria-expanded\":\"false\",\"aria-label\":\"Toggle navigation\",children:/*#__PURE__*/_jsx(\"span\",{className:\"navbar-toggler-icon\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"collapse navbar-collapse justify-content-end\",id:\"navbarNav\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"navbar-nav\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-sm btn-light\",onClick:logout,children:\"\\u767B\\u51FA\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-sm btn-light\",onClick:logout,children:/*#__PURE__*/_jsx(NavLink,{className:\"text-decoration-none link-dark\",to:\"/\",children:\"\\u56DE\\u524D\\u53F0\"})})})]})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",style:{minHeight:'calc(100vh - 56px)'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-light\",style:{width:'200px'},children:/*#__PURE__*/_jsxs(\"ul\",{className:\"list-group list-group-flush\",children:[/*#__PURE__*/_jsxs(NavLink,{className:\"list-group-item list-group-item-action py-3\",to:\"/admin/products\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-cup-fill me-2\"}),\"\\u7522\\u54C1\\u5217\\u8868\"]}),/*#__PURE__*/_jsxs(NavLink,{to:\"/admin/coupons\",className:\"list-group-item list-group-item-action py-3\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-ticket-perforated-fill me-2\"}),\"\\u512A\\u60E0\\u5377\\u5217\\u8868\"]}),/*#__PURE__*/_jsxs(NavLink,{className:\"list-group-item list-group-item-action py-3\",to:\"/admin/orders\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-receipt me-2\"}),\"\\u8A02\\u55AE\\u5217\\u8868\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-100\",children:token&&/*#__PURE__*/_jsx(Outlet,{})})]})]});}export default Dashboard;","map":{"version":3,"names":["Outlet","useNavigate","NavLink","axios","useEffect","useReducer","Message","MessageContext","messageReducer","initState","Dashboard","navigate","reducer","logout","document","cookie","token","split","find","row","startsWith","defaults","headers","common","post","response","data","success","minHeight","width"],"sources":["C:/Users/A3423/Desktop/Project/react-cra/src/pages/admin/Dashboard.js"],"sourcesContent":["import { Outlet, useNavigate, NavLink } from 'react-router-dom';\nimport axios from 'axios';\nimport { useEffect, useReducer } from 'react';\nimport Message from '../../components/Message';\nimport { MessageContext, messageReducer, initState } from '../../store/messageStore';\n\nfunction Dashboard() {\n  const navigate = useNavigate();\n  const reducer = useReducer(messageReducer, initState);\n\n  const logout = () => {\n    document.cookie = 'hexToken=;';\n    navigate('/login');\n  };\n\n  // 取出 Token\n  const token = document.cookie\n    .split('; ')\n    .find((row) => row.startsWith('hexToken='))\n    ?.split('=')[1];\n  axios.defaults.headers.common['Authorization'] = token;\n  useEffect(() => {\n    if (!token) {\n      return navigate('/login');\n    }\n    (async () => {\n      try {\n        await axios.post('/v2/api/user/check');\n      } catch (error) {\n        if (!error.response.data.success) {\n          navigate('/login');\n        }\n      }\n    })();\n  }, [navigate, token]);\n\n  return (\n    <MessageContext.Provider value={reducer}>\n      <Message />\n      <nav className='navbar navbar-expand-lg bg-dark'>\n        <div className='container-fluid'>\n          <p className='text-white mb-0'>超強早餐後台管理</p>\n          <button\n            className='navbar-toggler'\n            type='button'\n            data-bs-toggle='collapse'\n            data-bs-target='#navbarNav'\n            aria-controls='navbarNav'\n            aria-expanded='false'\n            aria-label='Toggle navigation'\n          >\n            <span className='navbar-toggler-icon' />\n          </button>\n          <div\n            className='collapse navbar-collapse justify-content-end'\n            id='navbarNav'\n          >\n            <ul className='navbar-nav'>\n              <li className='nav-item'>\n                <button\n                  type='button'\n                  className='btn btn-sm btn-light'\n                  onClick={logout}\n                >\n                  登出\n                </button>\n              </li>\n              <li className='nav-item'>\n                <button\n                  type='button'\n                  className='btn btn-sm btn-light'\n                  onClick={logout}\n                >\n                <NavLink className ='text-decoration-none link-dark' to='/'>回前台</NavLink>\n                </button>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </nav>\n      <div className='d-flex' style={{ minHeight: 'calc(100vh - 56px)' }}>\n        <div className='bg-light' style={{ width: '200px' }}>\n          <ul className='list-group list-group-flush'>\n            <NavLink\n              className='list-group-item list-group-item-action py-3'\n              to='/admin/products'\n            >\n              <i className='bi bi-cup-fill me-2' />\n              產品列表\n            </NavLink>\n            <NavLink\n              to='/admin/coupons'\n              className='list-group-item list-group-item-action py-3'\n            >\n              <i className='bi bi-ticket-perforated-fill me-2' />\n              優惠卷列表\n            </NavLink>\n            <NavLink\n              className='list-group-item list-group-item-action py-3'\n              to='/admin/orders'\n            >\n              <i className='bi bi-receipt me-2' />\n              訂單列表\n            </NavLink>\n          </ul>\n        </div>\n        <div className='w-100'>{token && <Outlet />}</div>\n      </div>\n    </MessageContext.Provider>\n  );\n}\n\nexport default Dashboard;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}