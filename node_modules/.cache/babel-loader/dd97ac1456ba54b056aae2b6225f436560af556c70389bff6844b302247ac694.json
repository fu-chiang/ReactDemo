{"ast":null,"code":"import _toConsumableArray from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import{useState}from'react';import{Link,useOutletContext}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Cart(){var _cartData$carts,_cartData$carts2;var _useOutletContext=useOutletContext(),cartData=_useOutletContext.cartData,getCart=_useOutletContext.getCart;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),loadingItems=_useState2[0],setLoadingItem=_useState2[1];var removeCartItem=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(id){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.delete(\"/v2/api/\".concat(process.env.REACT_APP_API_PATH,\"/cart/\").concat(id));case 3:res=_context.sent;console.log(res);getCart();_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 11:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function removeCartItem(_x){return _ref.apply(this,arguments);};}();var updateCartItem=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(item,quantity){var data,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:data={data:{product_id:item.product_id,qty:quantity}};setLoadingItem([].concat(_toConsumableArray(loadingItems),[item.id]));_context2.prev=2;_context2.next=5;return axios.put(\"/v2/api/\".concat(process.env.REACT_APP_API_PATH,\"/cart/\").concat(item.id),data);case 5:res=_context2.sent;console.log(res);setLoadingItem(loadingItems.filter(function(loadingObject){return loadingObject!==item.id;}));getCart();_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](2);console.log(_context2.t0);case 14:case\"end\":return _context2.stop();}},_callee2,null,[[2,11]]);}));return function updateCartItem(_x2,_x3){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 bg-white py-5 full-height\",children:(cartData===null||cartData===void 0?void 0:(_cartData$carts=cartData.carts)===null||_cartData$carts===void 0?void 0:_cartData$carts.length)===0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-secondary\",children:\"\\u9084\\u6C92\\u6709\\u9078\\u64C7\\u9910\\u9EDE\\u5594\"}),/*#__PURE__*/_jsx(Link,{to:\"/products\",className:\"btn btn-dark w-100 mt-4 rounded-0 py-3\",children:\"\\u9078\\u64C7\\u7F8E\\u5473\\u5957\\u9910\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-between\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"mt-2\",children:\"\\u60A8\\u7684\\u9910\\u9EDE\"})}),cartData===null||cartData===void 0?void 0:(_cartData$carts2=cartData.carts)===null||_cartData$carts2===void 0?void 0:_cartData$carts2.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex mt-4 bg-light\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.product.imageUrl,alt:\"\",className:\"object-cover\",style:{width:'120px'}}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-100 p-3 position-relative\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"position-absolute btn\",style:{top:'10px',right:'10px'},onClick:function onClick(){removeCartItem(item.id);},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-0 fw-bold\",children:item.product.title}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-1 text-muted\",style:{fontSize:'14px'},children:item.product.content}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center w-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group w-50 align-items-center\",children:/*#__PURE__*/_jsx(\"select\",{name:\"\",className:\"form-select\",id:\"\",value:item.qty,disabled:loadingItems.includes(item.id),onChange:function onChange(e){updateCartItem(item,e.target.value*1);},children:_toConsumableArray(new Array(20)).map(function(i,num){return/*#__PURE__*/_jsx(\"option\",{value:num+1,children:num+1},num);})})}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0 ms-auto\",children:[\"NT$\",item.final_total]})]})]})]},item.id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"mb-0 h4 fw-bold\",children:\"\\u7E3D\\u91D1\\u984D\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0 h4 fw-bold\",children:[\"NT$\",cartData.final_total]})]}),/*#__PURE__*/_jsx(Link,{to:\"/checkout\",className:\"btn btn-dark w-100 mt-4 rounded-0 py-3\",children:\"\\u78BA\\u8A8D\\u9910\\u9EDE\\u6B63\\u78BA\"})]})})})});}export default Cart;","map":{"version":3,"names":["axios","useState","Link","useOutletContext","Cart","cartData","getCart","loadingItems","setLoadingItem","removeCartItem","id","delete","process","env","REACT_APP_API_PATH","res","console","log","updateCartItem","item","quantity","data","product_id","qty","put","filter","loadingObject","carts","length","map","product","imageUrl","width","top","right","title","fontSize","content","includes","e","target","value","Array","i","num","final_total"],"sources":["C:/Users/A3423/Desktop/Project/react-cra/src/pages/front/Cart.js"],"sourcesContent":["import axios from 'axios';\nimport { useState } from 'react';\nimport { Link, useOutletContext } from 'react-router-dom';\n\nfunction Cart() {\n  const { cartData, getCart } = useOutletContext();\n  const [loadingItems, setLoadingItem] = useState([]);\n\n  const removeCartItem = async (id) => {\n    try {\n      const res = await axios.delete(\n        `/v2/api/${process.env.REACT_APP_API_PATH}/cart/${id}`,\n      );\n      console.log(res);\n      getCart();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const updateCartItem = async (item, quantity) => {\n    const data = {\n      data: {\n        product_id: item.product_id,\n        qty: quantity,\n      },\n    };\n    setLoadingItem([...loadingItems, item.id]);\n    try {\n      const res = await axios.put(\n        `/v2/api/${process.env.REACT_APP_API_PATH}/cart/${item.id}`,\n        data,\n      );\n      console.log(res);\n      setLoadingItem(\n        loadingItems.filter((loadingObject) => loadingObject !== item.id),\n      );\n      getCart();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return (\n    <div className='container'>\n      <div className='row justify-content-center'>\n        <div className='col-md-6 bg-white py-5 full-height'>\n          {cartData?.carts?.length === 0 ? (\n            <>\n              <div className='alert alert-secondary'>還沒有選擇餐點喔</div>\n              <Link\n                to='/products'\n                className='btn btn-dark w-100 mt-4 rounded-0 py-3'\n              >\n                選擇美味套餐\n              </Link>\n            </>\n          ) : (\n            <>\n              <div className='d-flex justify-content-between'>\n                <h2 className='mt-2'>您的餐點</h2>\n              </div>\n\n              {cartData?.carts?.map((item) => {\n                return (\n                  <div className='d-flex mt-4 bg-light' key={item.id}>\n                    <img\n                      src={item.product.imageUrl}\n                      alt=''\n                      className='object-cover'\n                      style={{\n                        width: '120px',\n                      }}\n                    />\n                    <div className='w-100 p-3 position-relative'>\n                      <button\n                        type='button'\n                        className='position-absolute btn'\n                        style={{ top: '10px', right: '10px' }}\n                        onClick={() => {\n                          removeCartItem(item.id);\n                        }}\n                      >\n                        <i className='bi bi-x-lg'></i>\n                      </button>\n                      <p className='mb-0 fw-bold'>{item.product.title}</p>\n                      <p\n                        className='mb-1 text-muted'\n                        style={{ fontSize: '14px' }}\n                      >\n                        {item.product.content}\n                      </p>\n                      <div className='d-flex justify-content-between align-items-center w-100'>\n                        <div className='input-group w-50 align-items-center'>\n                          <select\n                            name=''\n                            className='form-select'\n                            id=''\n                            value={item.qty}\n                            disabled={loadingItems.includes(item.id)}\n                            onChange={(e) => {\n                              updateCartItem(item, e.target.value * 1);\n                            }}\n                          >\n                            {[...new Array(20)].map((i, num) => {\n                              return (\n                                <option value={num + 1} key={num}>\n                                  {num + 1}\n                                </option>\n                              );\n                            })}\n                          </select>\n                        </div>\n                        <p className='mb-0 ms-auto'>NT${item.final_total}</p>\n                      </div>\n                    </div>\n                  </div>\n                );\n              })}\n              <div className='d-flex justify-content-between mt-4'>\n                <p className='mb-0 h4 fw-bold'>總金額</p>\n                <p className='mb-0 h4 fw-bold'>NT${cartData.final_total}</p>\n              </div>\n              <Link\n                to='/checkout'\n                className='btn btn-dark w-100 mt-4 rounded-0 py-3'\n              >\n                確認餐點正確\n              </Link>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Cart;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}