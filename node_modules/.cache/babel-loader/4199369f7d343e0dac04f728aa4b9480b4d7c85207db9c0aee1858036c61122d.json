{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{Link,useOutletContext,useNavigate}from'react-router-dom';import{useForm}from'react-hook-form';import{Input}from'../../components/FormElements';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Checkout(){var _cartData$carts;var _useOutletContext=useOutletContext(),cartData=_useOutletContext.cartData;var _useForm=useForm({mode:'onTouched'}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.formState.errors;var navigate=useNavigate();var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){var name,email,tel,address,form,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:name=data.name,email=data.email,tel=data.tel,address=data.address;form={data:{user:{name:name,email:email,tel:tel,address:address}}};_context.next=4;return axios.post(\"/v2/api/\".concat(process.env.REACT_APP_API_PATH,\"/order\"),form);case 4:res=_context.sent;console.log(res);navigate(\"/success/\".concat(res.data.orderId));case 7:case\"end\":return _context.stop();}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"bg-light pt-5 pb-7 full-height\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row justify-content-center flex-md-row flex-column-reverse\",children:[/*#__PURE__*/_jsxs(\"form\",{className:\"col-md-6\",onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"fw-bold\",children:\"\\u5916\\u9001\\u8CC7\\u6599\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsx(Input,{id:\"email\",labelText:\"Email\",type:\"email\",errors:errors,register:register,rules:{required:'Email 為必填',pattern:{value:/^\\S+@\\S+$/i,message:'Email 格式不正確'}}})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsx(Input,{id:\"name\",type:\"text\",errors:errors,labelText:\"\\u4F7F\\u7528\\u8005\\u540D\\u7A31\",register:register,rules:{required:'使用者名稱為必填',maxLength:{value:10,message:'使用者名稱長度不超過 10'}}})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsx(Input,{id:\"tel\",labelText:\"\\u96FB\\u8A71\",type:\"tel\",errors:errors,register:register,rules:{required:'電話為必填',minLength:{value:6,message:'電話不少於 6 碼'},maxLength:{value:12,message:'電話不超過 12 碼'}}})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsx(Input,{id:\"address\",labelText:\"\\u5730\\u5740\",type:\"address\",errors:errors,register:register,rules:{required:'地址為必填'}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end w-100\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/cart\",className:\"text-dark mt-md-0 mt-3\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-chevron-left me-2\"}),\" \\u7E7C\\u7E8C\\u9EDE\\u9910\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-dark py-3 px-7 rounded-0\",children:\"\\u9001\\u51FA\\u8868\\u55AE\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"border p-4 mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mb-4\",children:\"\\u9078\\u8CFC\\u9910\\u9EDE\"}),cartData===null||cartData===void 0?void 0:(_cartData$carts=cartData.carts)===null||_cartData$carts===void 0?void 0:_cartData$carts.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.product.imageUrl,alt:\"\",className:\"me-2\",style:{width:'48px',height:'48px',objectFit:'cover'}}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between fw-bold\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"mb-0\",children:item.product.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0\",children:[\"x\",item.qty]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:/*#__PURE__*/_jsxs(\"small\",{children:[\"NT$ \",item.product.price]})}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0\",children:[\"NT$ \",item.final_total]})]})]})]},'item.id');}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between mt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"mb-0 h4 fw-bold\",children:\"Total\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0 h4 fw-bold\",children:[\"NT$ \",cartData.final_total]})]})]})})]})})});}export default Checkout;","map":{"version":3,"names":["Link","useOutletContext","useNavigate","useForm","Input","axios","Checkout","cartData","mode","register","handleSubmit","errors","formState","navigate","onSubmit","data","name","email","tel","address","form","user","post","process","env","REACT_APP_API_PATH","res","console","log","orderId","required","pattern","value","message","maxLength","minLength","carts","map","item","product","imageUrl","width","height","objectFit","title","qty","price","final_total"],"sources":["C:/Users/A3423/Desktop/Project/react-cra/src/pages/front/Checkout.js"],"sourcesContent":["import { Link, useOutletContext, useNavigate } from 'react-router-dom';\nimport { useForm } from 'react-hook-form';\nimport { Input } from '../../components/FormElements';\nimport axios from 'axios';\n\nfunction Checkout() {\n  const { cartData } = useOutletContext();\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm({\n    mode: 'onTouched',\n  });\n  const navigate = useNavigate();\n\n  const onSubmit = async (data) => {\n    const { name, email, tel, address } = data;    \n    const form = {\n      data: {\n        user: {\n          name,\n          email,\n          tel,\n          address,\n        },\n      },\n    };\n    const res = await axios.post(\n      `/v2/api/${process.env.REACT_APP_API_PATH}/order`,\n      form,\n    );\n    console.log(res);\n    navigate(`/success/${res.data.orderId}`)\n  };\n\n  return (\n    <div className='bg-light pt-5 pb-7 full-height'>\n      <div className='container'>\n        <div className='row justify-content-center flex-md-row flex-column-reverse'>\n          <form className='col-md-6' onSubmit={handleSubmit(onSubmit)}>\n            <div className='bg-white p-4'>\n              <h4 className='fw-bold'>外送資料</h4>\n              <div className='mb-2'>\n                <Input\n                  id='email'\n                  labelText='Email'\n                  type='email'\n                  errors={errors}\n                  register={register}\n                  rules={{\n                    required: 'Email 為必填',\n                    pattern: {\n                      value: /^\\S+@\\S+$/i,\n                      message: 'Email 格式不正確',\n                    },\n                  }}\n                ></Input>\n              </div>\n              <div className='mb-2'>\n                <Input\n                  id='name'\n                  type='text'\n                  errors={errors}\n                  labelText='使用者名稱'\n                  register={register}\n                  rules={{\n                    required: '使用者名稱為必填',\n                    maxLength: {\n                      value: 10,\n                      message: '使用者名稱長度不超過 10',\n                    },\n                  }}\n                ></Input>\n              </div>\n              <div className='mb-2'>\n                <Input\n                  id='tel'\n                  labelText='電話'\n                  type='tel'\n                  errors={errors}\n                  register={register}\n                  rules={{\n                    required: '電話為必填',\n                    minLength: {\n                      value: 6,\n                      message: '電話不少於 6 碼',\n                    },\n                    maxLength: {\n                      value: 12,\n                      message: '電話不超過 12 碼',\n                    },\n                  }}\n                ></Input>\n              </div>\n              <div className='mb-2'>\n                <Input\n                  id='address'\n                  labelText='地址'\n                  type='address'\n                  errors={errors}\n                  register={register}\n                  rules={{\n                    required: '地址為必填',\n                  }}\n                ></Input>\n              </div>\n            </div>\n            <div className='d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end w-100'>\n              <Link to='/cart' className='text-dark mt-md-0 mt-3' >\n                <i className='bi bi-chevron-left me-2'></i> 繼續點餐\n              </Link>\n              <button\n                type='submit'\n                className='btn btn-dark py-3 px-7 rounded-0'\n              >\n                送出表單\n              </button>\n            </div>\n          </form>\n          <div className='col-md-4'>\n            <div className='border p-4 mb-4'>\n              <h4 className='mb-4'>選購餐點</h4>\n              {cartData?.carts?.map((item) => {\n                return (\n                  <div className='d-flex' key='item.id'>\n                    <img\n                      src={item.product.imageUrl}\n                      alt=''\n                      className='me-2'\n                      style={{\n                        width: '48px',\n                        height: '48px',\n                        objectFit: 'cover',\n                      }}\n                    />\n                    <div className='w-100'>\n                      <div className='d-flex justify-content-between fw-bold'>\n                        <p className='mb-0'>{item.product.title}</p>\n                        <p className='mb-0'>x{item.qty}</p>\n                      </div>\n                      <div className='d-flex justify-content-between'>\n                        <p className='text-muted mb-0'>\n                          <small>NT$ {item.product.price}</small>\n                        </p>\n                        <p className='mb-0'>NT$ {item.final_total}</p>\n                      </div>\n                    </div>\n                  </div>\n                );\n              })}\n              <div className='d-flex justify-content-between mt-4'>\n                <p className='mb-0 h4 fw-bold'>Total</p>\n                <p className='mb-0 h4 fw-bold'>NT$ {cartData.final_total}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Checkout;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}