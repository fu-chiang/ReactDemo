{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from'react';import axios from'axios';import{useOutletContext,useParams}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ProductDetail(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),product=_useState2[0],setProduct=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),cartQuantity=_useState4[0],setCartQuantity=_useState4[1];var _useParams=useParams(),id=_useParams.id;var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useOutletContext=useOutletContext(),getCart=_useOutletContext.getCart;var getProduct=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(id){var productRes;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/v2/api/\".concat(process.env.REACT_APP_API_PATH,\"/product/\").concat(id));case 2:productRes=_context.sent;console.log(productRes);setProduct(productRes.data.product);case 5:case\"end\":return _context.stop();}},_callee);}));return function getProduct(_x){return _ref.apply(this,arguments);};}();var addToCart=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var data,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:data={data:{product_id:product.id,qty:cartQuantity}};setIsLoading(true);_context2.prev=2;_context2.next=5;return axios.post(\"/v2/api/\".concat(process.env.REACT_APP_API_PATH,\"/cart\"),data);case 5:res=_context2.sent;console.log(res);getCart();setIsLoading(false);_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](2);console.log(_context2.t0);setIsLoading(false);case 15:case\"end\":return _context2.stop();}},_callee2,null,[[2,11]]);}));return function addToCart(){return _ref2.apply(this,arguments);};}();useEffect(function(){getProduct(id);},[id]);return/*#__PURE__*/_jsx(\"div\",{className:\"container full-height\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row justify-content-between mt-4 mb-7\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-7\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-0\",children:product.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-bold\",children:[\"NT$ \",product.price]}),/*#__PURE__*/_jsx(\"p\",{children:product.content}),/*#__PURE__*/_jsx(\"div\",{className:\"my-4\",children:/*#__PURE__*/_jsx(\"img\",{src:product.imageUrl,alt:\"\",className:\"img-fluid mt-4 rounded \"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3 border mt-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-prepend\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-dark rounded-0 border-0 py-3\",type:\"button\",id:\"button-addon1\",onClick:function onClick(){return setCartQuantity(function(pre){return pre===1?pre:pre-1;});},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-dash\"})})}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control border-0 text-center my-auto shadow-none\",placeholder:\"\",\"aria-label\":\"Example text with button addon\",\"aria-describedby\":\"button-addon1\",readOnly:true,value:cartQuantity}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group-append\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-dark rounded-0 border-0 py-3\",type:\"button\",id:\"button-addon2\",onClick:function onClick(){return setCartQuantity(function(pre){return pre+1;});},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus\"})})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-dark w-100 rounded-0 py-3\",onClick:function onClick(){return addToCart();},disabled:isLoading,children:\"\\u52A0\\u5165\\u8CFC\\u7269\\u8ECA\"})]})]})});}export default ProductDetail;","map":{"version":3,"names":["useEffect","useState","axios","useOutletContext","useParams","ProductDetail","product","setProduct","cartQuantity","setCartQuantity","id","isLoading","setIsLoading","getCart","getProduct","get","process","env","REACT_APP_API_PATH","productRes","console","log","data","addToCart","product_id","qty","post","res","title","price","content","imageUrl","pre"],"sources":["C:/Users/A3423/Desktop/Project/react-cra/src/pages/front/ProductDetail.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useOutletContext, useParams } from 'react-router-dom';\n\nfunction ProductDetail() {\n  const [product, setProduct] = useState({});\n  const [cartQuantity, setCartQuantity] = useState(1);\n  const { id } = useParams();\n  const [isLoading, setIsLoading] = useState(false)\n  const { getCart } = useOutletContext();\n\n  const getProduct = async (id) => {\n    const productRes = await axios.get(\n      `/v2/api/${process.env.REACT_APP_API_PATH}/product/${id}`,\n    );\n    console.log(productRes);\n    setProduct(productRes.data.product);\n  };\n\n  const addToCart = async () => {\n    const data = {\n      data: {\n        product_id: product.id,\n        qty: cartQuantity,\n      },\n    };\n    setIsLoading(true);\n    try {\n      const res = await axios.post(\n        `/v2/api/${process.env.REACT_APP_API_PATH}/cart`,\n        data,\n      );\n      console.log(res);\n      getCart();\n      setIsLoading(false)\n    } catch (error) {\n      console.log(error);\n      setIsLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    getProduct(id);\n  }, [id]);\n\n\n  return (\n    <div className='container full-height'>\n      <div className='row justify-content-between mt-4 mb-7'>\n        <div className='col-md-7'>\n          <h2 className='mb-0'>{product.title}</h2>\n          <p className='fw-bold'>NT$ {product.price}</p>\n          <p>{product.content}</p>\n          <div className='my-4'>\n            <img src={product.imageUrl} alt='' className='img-fluid mt-4 rounded '/>\n          </div>\n        </div>\n        <div className='col-md-4'>\n          <div className='input-group mb-3 border mt-3'>\n            <div className='input-group-prepend'>\n              <button\n                className='btn btn-outline-dark rounded-0 border-0 py-3'\n                type='button'\n                id='button-addon1'\n                onClick={() =>\n                  setCartQuantity((pre) => (pre === 1 ? pre : pre - 1))\n                }\n              >\n                <i className='bi bi-dash'></i>\n              </button>\n            </div>\n            <input\n              type='number'\n              className='form-control border-0 text-center my-auto shadow-none'\n              placeholder=''\n              aria-label='Example text with button addon'\n              aria-describedby='button-addon1'\n              readOnly\n              value={cartQuantity}\n            />\n            <div className='input-group-append'>\n              <button\n                className='btn btn-outline-dark rounded-0 border-0 py-3'\n                type='button'\n                id='button-addon2'\n                onClick={() => setCartQuantity((pre) => pre + 1)}\n              >\n                <i className='bi bi-plus'></i>\n              </button>\n            </div>\n          </div>\n          <button\n            type='button'\n            className='btn btn-dark w-100 rounded-0 py-3'\n            onClick={() => addToCart()}\n            disabled={isLoading}\n          >\n            加入購物車\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default ProductDetail;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}