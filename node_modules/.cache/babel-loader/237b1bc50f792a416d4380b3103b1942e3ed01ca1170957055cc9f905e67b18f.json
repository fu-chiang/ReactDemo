{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useRef,useState}from'react';import axios from\"axios\";import OrderModal from\"../../components/OrderModal\";import Pagination from\"../../components/Pagination\";import{Modal}from\"bootstrap\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AdminOrders(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),orders=_useState2[0],setOrders=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),pagination=_useState4[0],setPagination=_useState4[1];// type: 決定 modal 展開的用途\nvar _useState5=useState('create'),_useState6=_slicedToArray(_useState5,2),type=_useState6[0],setType=_useState6[1];// edit\nvar _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),tempOrder=_useState8[0],setTempOrder=_useState8[1];var orderModal=useRef(null);useEffect(function(){orderModal.current=new Modal('#orderModal',{backdrop:'static'});getOrders();},[]);var getOrders=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var page,res,_args=arguments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:page=_args.length>0&&_args[0]!==undefined?_args[0]:1;_context.next=3;return axios.get(\"/v2/api/\".concat(process.env.REACT_APP_API_PATH,\"/admin/orders?page=\").concat(page));case 3:res=_context.sent;console.log(res);setOrders(res.data.orders);setPagination(res.data.pagination);case 7:case\"end\":return _context.stop();}},_callee);}));return function getOrders(){return _ref.apply(this,arguments);};}();var openOrderModal=function openOrderModal(order){setTempOrder(order);orderModal.current.show();};var closeOrderModal=function closeOrderModal(){setTempOrder({});orderModal.current.hide();};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-3\",children:[/*#__PURE__*/_jsx(OrderModal,{closeProductModal:closeOrderModal,getOrders:getOrders,tempOrder:tempOrder}),/*#__PURE__*/_jsx(\"h3\",{children:\"\\u8A02\\u55AE\\u5217\\u8868\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u8A02\\u55AE id\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u8CFC\\u8CB7\\u7528\\u6236\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u8A02\\u55AE\\u91D1\\u984D\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u4ED8\\u6B3E\\u72C0\\u614B\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u4ED8\\u6B3E\\u65E5\\u671F\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u7559\\u8A00\\u8A0A\\u606F\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u7DE8\\u8F2F\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map(function(order){var _order$user,_order$user2;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order.id}),/*#__PURE__*/_jsxs(\"td\",{children:[(_order$user=order.user)===null||_order$user===void 0?void 0:_order$user.name,(_order$user2=order.user)===null||_order$user2===void 0?void 0:_order$user2.email]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",order.total]}),/*#__PURE__*/_jsx(\"td\",{children:order.is_paid?/*#__PURE__*/_jsx(\"span\",{className:\"text-success fw-bold\",children:\"\\u4ED8\\u6B3E\\u5B8C\\u6210\"}):'未付款'}),/*#__PURE__*/_jsx(\"td\",{children:order.paid_date?new Date(order.paid_date*1000).toLocaleString():'未付款'}),/*#__PURE__*/_jsx(\"td\",{children:order.message}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary btn-sm\",onClick:function onClick(){openOrderModal(order);},children:\"\\u67E5\\u770B\"})})]},order.id);})})]}),/*#__PURE__*/_jsx(Pagination,{pagination:pagination,changePage:getOrders})]});}export default AdminOrders;","map":{"version":3,"names":["useEffect","useRef","useState","axios","OrderModal","Pagination","Modal","AdminOrders","orders","setOrders","pagination","setPagination","type","setType","tempOrder","setTempOrder","orderModal","current","backdrop","getOrders","page","get","process","env","REACT_APP_API_PATH","res","console","log","data","openOrderModal","order","show","closeOrderModal","hide","map","id","user","name","email","total","is_paid","paid_date","Date","toLocaleString","message"],"sources":["C:/Users/A3423/Desktop/Project/react-cra/src/pages/admin/AdminOrders.js"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport axios from \"axios\";\nimport OrderModal from \"../../components/OrderModal\";\nimport Pagination from \"../../components/Pagination\";\nimport { Modal } from \"bootstrap\";\n\nfunction AdminOrders() {\n  const [orders, setOrders] = useState([]);\n  const [pagination, setPagination] = useState({});\n  // type: 決定 modal 展開的用途\n  const [type, setType] = useState('create'); // edit\n  const [tempOrder, setTempOrder] = useState({});\n\n  const orderModal = useRef(null);\n  useEffect(() => {\n    orderModal.current = new Modal('#orderModal', {\n      backdrop: 'static',\n    });\n\n    getOrders();\n  }, []);\n\n  const getOrders = async (page = 1) => {\n    const res = await axios.get(\n      `/v2/api/${process.env.REACT_APP_API_PATH}/admin/orders?page=${page}`,\n    );\n    console.log(res);\n    setOrders(res.data.orders);\n    setPagination(res.data.pagination);\n  }\n\n  const openOrderModal = (order) => {\n    setTempOrder(order);\n    orderModal.current.show();\n  }\n  const closeOrderModal = () => {\n    setTempOrder({});\n    orderModal.current.hide();\n  }\n\n  return (\n    <div className='p-3'>\n      <OrderModal\n        closeProductModal={closeOrderModal}\n        getOrders={getOrders}\n        tempOrder={tempOrder}\n      />\n      <h3>訂單列表</h3>\n      <hr />\n      <table className='table'>\n        <thead>\n          <tr>\n            <th scope='col'>訂單 id</th>\n            <th scope='col'>購買用戶</th>\n            <th scope='col'>訂單金額</th>\n            <th scope='col'>付款狀態</th>\n            <th scope='col'>付款日期</th>\n            <th scope='col'>留言訊息</th>\n            <th scope='col'>編輯</th>\n          </tr>\n        </thead>\n        <tbody>\n          {orders.map((order) => {\n            return (\n              <tr key={order.id}>\n                <td>{order.id}</td>\n                <td>\n                  {order.user?.name}\n                  {order.user?.email}\n                </td>\n                <td>${order.total}</td>\n                <td>\n                  {order.is_paid ? (\n                    <span className='text-success fw-bold'>付款完成</span>\n                  ) : (\n                    '未付款'\n                  )}\n                </td>\n                <td>\n                  {order.paid_date\n                    ? new Date(order.paid_date * 1000).toLocaleString()\n                    : '未付款'}\n                </td>\n                <td>{order.message}</td>\n\n                <td>\n                  <button\n                    type='button'\n                    className='btn btn-primary btn-sm'\n                    onClick={() => {\n                      openOrderModal(order);\n                    }}\n                  >\n                    查看\n                  </button>\n                </td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n      <Pagination pagination={pagination} changePage={getOrders} />\n    </div>\n  );\n}\n\nexport default AdminOrders;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}