{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/A3423/Desktop/Project/react-cra/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import{useState}from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var navigate=useNavigate();var _useState=useState({username:'',password:''}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),loginState=_useState4[0],setLoginState=_useState4[1];var handleChange=function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setData(_objectSpread(_objectSpread({},data),{},_defineProperty({},name,value)));};var submit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var res,_res$data,token,expired;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post('/v2/admin/signin',data);case 3:res=_context.sent;_res$data=res.data,token=_res$data.token,expired=_res$data.expired;console.log(res.data);document.cookie=\"hexToken=\".concat(token,\"; expires=\").concat(new Date(expired),\";\");// 儲存 Token\nif(res.data.success){navigate('/admin/products');}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);setLoginState(_context.t0.response.data);case 13:case\"end\":return _context.stop();}},_callee,null,[[0,10]]);}));return function submit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"container py-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u767B\\u5165\\u5E33\\u865F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger \".concat(loginState.message?'d-block':'d-none'),role:\"alert\",children:loginState.message}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"email\",className:\"form-label w-100\",children:[\"Email\",/*#__PURE__*/_jsx(\"input\",{id:\"email\",className:\"form-control\",name:\"username\",type:\"email\",placeholder:\"Email Address\",onChange:handleChange})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"password\",className:\"form-label w-100\",children:[\"\\u5BC6\\u78BC\",/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",name:\"password\",id:\"password\",placeholder:\"name@example.com\",onChange:handleChange})]})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary\",onClick:submit,children:\"\\u767B\\u5165\"})]})})});}export default Login;","map":{"version":3,"names":["axios","useState","useNavigate","Login","navigate","username","password","data","setData","loginState","setLoginState","handleChange","e","target","name","value","submit","post","res","token","expired","console","log","document","cookie","Date","success","response","message"],"sources":["C:/Users/A3423/Desktop/Project/react-cra/src/pages/Login.js"],"sourcesContent":["import axios from 'axios';\nimport { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nfunction Login() {\n  const navigate = useNavigate()\n  const [data, setData] = useState({\n    username: '',\n    password: '',\n  });\n  const [loginState, setLoginState] = useState({});\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setData({ ...data, [name]: value });\n  };\n\n  const submit = async (e) => {\n    try {\n      const res = await axios.post('/v2/admin/signin', data);\n      const { token, expired } = res.data;\n      console.log(res.data);\n      document.cookie = `hexToken=${token}; expires=${new Date(expired)};`;\n      // 儲存 Token\n      if (res.data.success) {\n        navigate('/admin/products')\n      }\n    } catch (error) {\n      setLoginState(error.response.data);\n    }\n  };\n\n  return (\n    <div className='container py-5'>\n      <div className='row justify-content-center'>\n        <div className='col-md-6'>\n          <h2>登入帳號</h2>\n\n          <div\n            className={`alert alert-danger ${\n              loginState.message ? 'd-block' : 'd-none'\n            }`}\n            role='alert'\n          >\n            {loginState.message}\n          </div>\n          <div className='mb-2'>\n            <label htmlFor='email' className='form-label w-100'>\n              Email\n              <input\n                id='email'\n                className='form-control'\n                name='username'\n                type='email'\n                placeholder='Email Address'\n                onChange={handleChange}\n              />\n            </label>\n          </div>\n          <div className='mb-2'>\n            <label htmlFor='password' className='form-label w-100'>\n              密碼\n              <input\n                type='password'\n                className='form-control'\n                name='password'\n                id='password'\n                placeholder='name@example.com'\n                onChange={handleChange}\n              />\n            </label>\n          </div>\n          <button type='button' className='btn btn-primary' onClick={submit}>\n            登入\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Login;\n"],"mappings":"uoBAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,KAAQ,OAAO,CAChC,OAASC,WAAW,KAAQ,kBAAkB,CAAC,wFAE/C,QAASC,MAAK,EAAG,CACf,GAAMC,SAAQ,CAAGF,WAAW,EAAE,CAC9B,cAAwBD,QAAQ,CAAC,CAC/BI,QAAQ,CAAE,EAAE,CACZC,QAAQ,CAAE,EACZ,CAAC,CAAC,wCAHKC,IAAI,eAAEC,OAAO,eAIpB,eAAoCP,QAAQ,CAAC,CAAC,CAAC,CAAC,yCAAzCQ,UAAU,eAAEC,aAAa,eAEhC,GAAMC,aAAY,CAAG,QAAfA,aAAY,CAAIC,CAAC,CAAK,CAC1B,cAAwBA,CAAC,CAACC,MAAM,CAAxBC,IAAI,WAAJA,IAAI,CAAEC,KAAK,WAALA,KAAK,CACnBP,OAAO,gCAAMD,IAAI,wBAAGO,IAAI,CAAGC,KAAK,GAAG,CACrC,CAAC,CAED,GAAMC,OAAM,4FAAG,iBAAOJ,CAAC,yLAEDZ,MAAK,CAACiB,IAAI,CAAC,kBAAkB,CAAEV,IAAI,CAAC,QAAhDW,GAAG,yBACkBA,GAAG,CAACX,IAAI,CAA3BY,KAAK,WAALA,KAAK,CAAEC,OAAO,WAAPA,OAAO,CACtBC,OAAO,CAACC,GAAG,CAACJ,GAAG,CAACX,IAAI,CAAC,CACrBgB,QAAQ,CAACC,MAAM,oBAAeL,KAAK,sBAAa,GAAIM,KAAI,CAACL,OAAO,CAAC,KAAG,CACpE;AACA,GAAIF,GAAG,CAACX,IAAI,CAACmB,OAAO,CAAE,CACpBtB,QAAQ,CAAC,iBAAiB,CAAC,CAC7B,CAAC,iFAEDM,aAAa,CAAC,YAAMiB,QAAQ,CAACpB,IAAI,CAAC,CAAC,oEAEtC,kBAbKS,OAAM,4CAaX,CAED,mBACE,YAAK,SAAS,CAAC,gBAAgB,uBAC7B,YAAK,SAAS,CAAC,4BAA4B,uBACzC,aAAK,SAAS,CAAC,UAAU,wBACvB,oBAAI,0BAAI,EAAK,cAEb,YACE,SAAS,8BACPP,UAAU,CAACmB,OAAO,CAAG,SAAS,CAAG,QAAQ,CACxC,CACH,IAAI,CAAC,OAAO,UAEXnB,UAAU,CAACmB,OAAO,EACf,cACN,YAAK,SAAS,CAAC,MAAM,uBACnB,eAAO,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,kBAAkB,WAAC,OAElD,4BACE,EAAE,CAAC,OAAO,CACV,SAAS,CAAC,cAAc,CACxB,IAAI,CAAC,UAAU,CACf,IAAI,CAAC,OAAO,CACZ,WAAW,CAAC,eAAe,CAC3B,QAAQ,CAAEjB,YAAa,EACvB,GACI,EACJ,cACN,YAAK,SAAS,CAAC,MAAM,uBACnB,eAAO,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,kBAAkB,WAAC,cAErD,4BACE,IAAI,CAAC,UAAU,CACf,SAAS,CAAC,cAAc,CACxB,IAAI,CAAC,UAAU,CACf,EAAE,CAAC,UAAU,CACb,WAAW,CAAC,kBAAkB,CAC9B,QAAQ,CAAEA,YAAa,EACvB,GACI,EACJ,cACN,eAAQ,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,iBAAiB,CAAC,OAAO,CAAEK,MAAO,UAAC,cAEnE,EAAS,GACL,EACF,EACF,CAEV,CAEA,cAAeb,MAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}